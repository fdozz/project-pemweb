<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover" />
    <title>Profil - <%= user.name || user.email %> - Nontonmantap</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="navbar">
      <div class="brand">
        <div class="logo">ğŸ¬ Nontonmantap</div>
      </div>
      <div class="nav-links">
        <a href="/"><span class="hide-mobile">â† Kembali ke Beranda</span><span class="show-mobile">â† Beranda</span></a>
        <a class="profile-link" href="/profile">ğŸ‘¤ <%= user.name || user.email %></a>
        <a href="/logout">Keluar</a>
      </div>
    </header>

    <main>
      <div class="content-wrap">
        <!-- Profile Header -->
        <div class="profile-header" style="background: var(--accent-gradient); padding: 3rem 2rem; border-radius: 16px; margin: 2rem 0; text-align: center; position: relative; overflow: hidden;">
          <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.05); opacity: 0.3;"></div>
          <div class="profile-content" style="position: relative; z-index: 2;">
            <div class="profile-avatar" style="width: 100px; height: 100px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 3rem; backdrop-filter: blur(10px);">
              ğŸ‘¤
            </div>
            <h1 class="profile-name" style="margin: 0 0 0.5rem; font-size: 2rem; font-weight: 800;"><%= user.name || 'Pengguna' %></h1>
            <p class="profile-email" style="margin: 0; opacity: 0.9; font-size: 1.1rem;"><%= user.email %></p>
            <div class="profile-stats" style="margin-top: 1.5rem; display: flex; gap: 2rem; justify-content: center; flex-wrap: wrap;">
              <div class="stat-item" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700;"><%= watched.length %></div>
                <div style="opacity: 0.8; font-size: 0.9rem;">Film Dikomentari</div>
              </div>
              <div class="stat-item" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700;">ğŸ†</div>
                <div style="opacity: 0.8; font-size: 0.9rem;">Member Premium</div>
              </div>
              <div class="stat-item" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700;">â­</div>
                <div style="opacity: 0.8; font-size: 0.9rem;">Pengguna Aktif</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Activity Section -->
        <section class="row">
          <h3>ğŸ’¬ Aktivitas Terbaru</h3>
          
          <% if (watched.length === 0) { %>
            <div style="background: var(--bg-card); padding: 3rem 2rem; border-radius: 12px; text-align: center; color: var(--text-muted);">
              <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¬</div>
              <h4 style="margin: 0 0 1rem; color: var(--text-primary);">Belum Ada Aktivitas</h4>
              <p style="margin: 0 0 2rem;">Mulai menonton dan berikan komentar pada film favorit Anda!</p>
              <a href="/" class="btn info">ğŸ” Jelajahi Film</a>
            </div>
          <% } else { %>
            <div class="activity-grid" style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));">
              <% watched.forEach((m, index) => { %>
                <div class="activity-card" style="background: var(--bg-card); border-radius: 12px; overflow: hidden; transition: var(--transition); border: 1px solid rgba(255,255,255,0.1);" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                  <div style="position: relative;">
                    <img src="<%= m.thumbnail %>" alt="<%= m.title %>" style="width: 100%; height: 180px; object-fit: cover;" />
                    <div style="position: absolute; top: 12px; right: 12px; background: rgba(0,0,0,0.8); padding: 0.5rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                      ğŸ’¬ Dikomentari
                    </div>
                  </div>
                  <div class="activity-content" style="padding: 1.5rem;">
                    <h4 style="margin: 0 0 0.5rem; color: var(--text-primary); font-size: 1.1rem;"><%= m.title %></h4>
                    <p style="margin: 0 0 1rem; color: var(--text-secondary); font-size: 0.9rem; opacity: 0.8;"><%= m.genre %></p>
                    <p style="margin: 0 0 1.5rem; color: var(--text-muted); font-size: 0.9rem; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;"><%= m.synopsis %></p>
                    <a href="/movie/<%= m.id %>" class="btn info" style="width: 100%; text-align: center; text-decoration: none;">
                      â–¶ï¸ Tonton Lagi
                    </a>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } %>
        </section>

        <!-- Stats Section -->
        <section class="row">
          <h3>ğŸ“ˆ Statistik Menonton</h3>
          <div class="stats-grid" style="display: grid; gap: 1.5rem; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 2rem; border-radius: 12px; text-align: center; color: white;">
              <div class="stat-icon" style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ¬</div>
              <div class="stat-number" style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;"><%= watched.length %></div>
              <div class="stat-label" style="opacity: 0.9;">Film Dikomentari</div>
            </div>
            
            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 2rem; border-radius: 12px; text-align: center; color: white;">
              <div class="stat-icon" style="font-size: 2.5rem; margin-bottom: 0.5rem;">â¤ï¸</div>
              <div class="stat-number" style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;"><%= Math.floor(Math.random() * 50) + 10 %></div>
              <div class="stat-label" style="opacity: 0.9;">Film Favorit</div>
            </div>
            
            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 2rem; border-radius: 12px; text-align: center; color: white;">
              <div class="stat-icon" style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ”¥</div>
              <div class="stat-number" style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;"><%= Math.floor(Math.random() * 100) + 50 %></div>
              <div class="stat-label" style="opacity: 0.9;">Jam Menonton</div>
            </div>
            
            <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 2rem; border-radius: 12px; text-align: center; color: white;">
              <div class="stat-icon" style="font-size: 2.5rem; margin-bottom: 0.5rem;">â­</div>
              <div class="stat-number" style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;"><%= Math.floor(Math.random() * 5) + 8 %>.<%= Math.floor(Math.random() * 10) %></div>
              <div class="stat-label" style="opacity: 0.9;">Rating Rata-rata</div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <footer class="footer">
      <p>ğŸ¬ <strong>Nontonmantap</strong> - Platform Streaming Terbaik Indonesia</p>
    </footer>

    <script src="/app.js"></script>
  </body>
</html>
